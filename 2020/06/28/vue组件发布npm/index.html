<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>vue组件发布npm | Shetia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="vue组件发布npm整个流程记录一下组件发布流程，参考Vue cli3 库模式搭建组件库并发布到 npm 起步首先，我们从零开始搭建一个vue项目，以vue-cli3 来搭建。 1vue create my-project 长这样子的：  调整目录安装项目之后我们来修改一下目录结构 123456....|-- examples      &#x2F;&#x2F; 原 src 目录，改成 examp">
<meta property="og:type" content="article">
<meta property="og:title" content="vue组件发布npm">
<meta property="og:url" content="https://shetia.github.io/blog/2020/06/28/vue%E7%BB%84%E4%BB%B6%E5%8F%91%E5%B8%83npm/index.html">
<meta property="og:site_name" content="Shetia">
<meta property="og:description" content="vue组件发布npm整个流程记录一下组件发布流程，参考Vue cli3 库模式搭建组件库并发布到 npm 起步首先，我们从零开始搭建一个vue项目，以vue-cli3 来搭建。 1vue create my-project 长这样子的：  调整目录安装项目之后我们来修改一下目录结构 123456....|-- examples      &#x2F;&#x2F; 原 src 目录，改成 examp">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/9/26/16d6b543812fabb0?w=1024&h=768&f=png&s=94536">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/9/26/16d6b4b00ee600ff?w=818&h=632&f=png&s=22950">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/9/26/16d6b5af7920d49a?w=661&h=454&f=png&s=55267">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/9/26/16d6b4d68c9e8584?w=1080&h=953&f=png&s=179381">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/9/26/16d6b5bc7ab28000?w=661&h=514&f=png&s=92420">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/9/26/16d6b4f823ed90c6?w=1906&h=942&f=png&s=85791">
<meta property="article:published_time" content="2020-06-28T07:56:10.000Z">
<meta property="article:modified_time" content="2020-06-28T07:58:10.704Z">
<meta property="article:author" content="shetia">
<meta property="article:tag" content="vue">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://user-gold-cdn.xitu.io/2019/9/26/16d6b543812fabb0?w=1024&h=768&f=png&s=94536">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/blog/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">Shetia</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">主页</a>
        
          <a class="main-nav-link" href="/blog/archives">档案</a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://shetia.github.io/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-vue组件发布npm" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2020/06/28/vue%E7%BB%84%E4%BB%B6%E5%8F%91%E5%B8%83npm/" class="article-date">
  <time datetime="2020-06-28T07:56:10.000Z" itemprop="datePublished">2020-06-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      vue组件发布npm
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="vue组件发布npm整个流程"><a href="#vue组件发布npm整个流程" class="headerlink" title="vue组件发布npm整个流程"></a>vue组件发布npm整个流程</h2><p>记录一下组件发布流程，参考<a href="http://www.rxshc.com/180.html" target="_blank" rel="noopener">Vue cli3 库模式搭建组件库并发布到 npm</a></p>
<h3 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h3><p>首先，我们从零开始搭建一个vue项目，以vue-cli3 来搭建。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue create my-project</span><br></pre></td></tr></table></figure>
<p>长这样子的：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/9/26/16d6b543812fabb0?w=1024&h=768&f=png&s=94536" alt></p>
<h3 id="调整目录"><a href="#调整目录" class="headerlink" title="调整目录"></a>调整目录</h3><p>安装项目之后我们来修改一下目录结构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">...</span><br><span class="line">|-- examples      &#x2F;&#x2F; 原 src 目录，改成 examples 用作示例展示</span><br><span class="line">|-- packages      &#x2F;&#x2F; 新增 packages 用于编写存放组件</span><br><span class="line">...</span><br><span class="line">.</span><br></pre></td></tr></table></figure>

<p>修改之后，运行项目我们会发现报错了，那是因为目录结构改了，还有就是packges这个文件夹是我们新增的，webpack无法获取编译，我们需要在webpack里加上。</p>
<p>我们会新建一个vue.config.js的配置文件，这个vue-cli3提供的一个可选配置文件，我们可以在里面配置整个项目所有的webpack配置。<br>我们可以直接去 <a href="https://cli.vuejs.org/zh/config/#pages" target="_blank" rel="noopener">vue-cli3的配置</a> 复制过来,而 <a href="https://cli.vuejs.org/zh/guide/webpack.html#%E9%93%BE%E5%BC%8F%E6%93%8D%E4%BD%9C-%E9%AB%98%E7%BA%A7" target="_blank" rel="noopener">chainWebpack</a> 会给我们提供链式操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vue-config.js</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="comment">// 修改 src 目录 为 examples 目录</span></span><br><span class="line">  pages: &#123;</span><br><span class="line">    index: &#123;</span><br><span class="line">      <span class="comment">// page 的入口</span></span><br><span class="line">      entry: <span class="string">'examples/main.js'</span>,   <span class="comment">// 把src 修改为examples</span></span><br><span class="line">      <span class="comment">// 模板来源</span></span><br><span class="line">      template: <span class="string">'public/index.html'</span>,</span><br><span class="line">      <span class="comment">// 在 dist/index.html 的输出</span></span><br><span class="line">      filename: <span class="string">'index.html'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// 扩展 webpack 配置，使 packages 加入编译</span></span><br><span class="line">  <span class="comment">/* chainWebpack 是一个函数，会接收一个基于 webpack-chain 的 ChainableConfig 实例。</span></span><br><span class="line"><span class="comment">  允许对内部的 webpack 配置进行更细粒度的修改。</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  chainWebpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    config.module</span><br><span class="line">      .rule(<span class="string">'js'</span>)</span><br><span class="line">      .include</span><br><span class="line">        .add(__dirname + <span class="string">'packages'</span>)  <span class="comment">// 注意这里需要绝对路径，所有要拼接__dirname</span></span><br><span class="line">        .end()</span><br><span class="line">      .use(<span class="string">'babel'</span>)</span><br><span class="line">        .loader(<span class="string">'babel-loader'</span>)</span><br><span class="line">        .tap(<span class="function"><span class="params">options</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// 修改它的选项...</span></span><br><span class="line">          <span class="keyword">return</span> options</span><br><span class="line">        &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上就是基本的配置，接下来我们就开始创建一个组件</p>
<h3 id="编写组件"><a href="#编写组件" class="headerlink" title="编写组件"></a>编写组件</h3><p>这里我就以一个按钮组件来做尝试。<br>在之前我们新建的 packages 目录中新建 comColorButton 文件夹和index.js文件，然后再在comColorButton文件夹里，创建src文件夹和index.js文件，目录结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">|——</span><br><span class="line">|——packages</span><br><span class="line">|   |——index.js</span><br><span class="line">|   |——comColorButton</span><br><span class="line">|      |——index.js</span><br><span class="line">|      |——src</span><br><span class="line">|         |——color-button.vue</span><br><span class="line">|——</span><br></pre></td></tr></table></figure>
<p>这是color-button.vue的内容</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- color-button.vue --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"color-button"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">:class</span>=<span class="string">"[type, disabled?'disabled':'']"</span> <span class="attr">:disabled</span>=<span class="string">"disabled"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="actionscript">  name:<span class="string">'ComColorButton'</span>,</span></span><br><span class="line">  props:&#123;</span><br><span class="line">      type:&#123;</span><br><span class="line"><span class="javascript">      type:<span class="built_in">String</span>,</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">default</span>:<span class="string">'primary'</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">      disabled:&#123;</span><br><span class="line"><span class="javascript">      type:<span class="built_in">Boolean</span>,</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">default</span>:<span class="literal">false</span></span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;, </span><br><span class="line">  data () &#123;</span><br><span class="line"><span class="actionscript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">'scss'</span>&gt;</span></span><br><span class="line">$pColor:#333;</span><br><span class="line">$sColor:#0db677;</span><br><span class="line">$wColor:orange;</span><br><span class="line">$dColor:red;</span><br><span class="line">$disabledColor:gray;</span><br><span class="line"><span class="css"><span class="selector-class">.color-button</span>&#123;</span></span><br><span class="line">  display: inline-block;</span><br><span class="line"><span class="css">  <span class="selector-tag">margin-right</span><span class="selector-pseudo">:10px</span>;</span></span><br><span class="line">  button&#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line"><span class="css">    <span class="selector-tag">padding</span><span class="selector-pseudo">:10px</span> 20<span class="selector-tag">px</span>;</span></span><br><span class="line">    border:2px solid $pColor;</span><br><span class="line"><span class="css">    <span class="selector-tag">background</span>:<span class="selector-id">#fff</span>;</span></span><br><span class="line">    font-size: 16px;</span><br><span class="line"><span class="css">    <span class="selector-tag">width</span><span class="selector-pseudo">:auto</span>;</span></span><br><span class="line">    cursor: pointer;</span><br><span class="line"><span class="css">    <span class="selector-tag">transition</span><span class="selector-pseudo">:all</span> 0<span class="selector-class">.5s</span>;</span></span><br><span class="line"><span class="css">    &amp;<span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line">      box-shadow: 100px 0px 0px 0px $pColor inset;</span><br><span class="line"><span class="css">      <span class="selector-tag">color</span>:<span class="selector-id">#fff</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    &amp;<span class="selector-class">.success</span>&#123;</span></span><br><span class="line">      border:2px solid $sColor;</span><br><span class="line">      color: $sColor;</span><br><span class="line"><span class="css">      &amp;<span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line">        box-shadow: 100px 0px 0px 0px $sColor inset;</span><br><span class="line"><span class="css">        <span class="selector-tag">color</span>:<span class="selector-id">#fff</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    &amp;<span class="selector-class">.warning</span>&#123;</span></span><br><span class="line">      border:2px solid $wColor;</span><br><span class="line">      color: $wColor;</span><br><span class="line"><span class="css">      &amp;<span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line">        box-shadow: 100px 0px 0px 0px $wColor inset;</span><br><span class="line"><span class="css">        <span class="selector-tag">color</span>:<span class="selector-id">#fff</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    &amp;<span class="selector-class">.danger</span>&#123;</span></span><br><span class="line">      border:2px solid $dColor;</span><br><span class="line">      color: $dColor;</span><br><span class="line"><span class="css">      &amp;<span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line">        box-shadow: 100px 0px 0px 0px $dColor inset;</span><br><span class="line"><span class="css">        <span class="selector-tag">color</span>:<span class="selector-id">#fff</span>;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    &amp;<span class="selector-class">.disabled</span>&#123;</span></span><br><span class="line">      border:2px solid $disabledColor;</span><br><span class="line">      color: $disabledColor;</span><br><span class="line"><span class="css">      <span class="selector-tag">cursor</span><span class="selector-pseudo">:not-allowed</span> ;</span></span><br><span class="line"><span class="css">      &amp;<span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="css">        <span class="selector-tag">box-shadow</span><span class="selector-pseudo">:none</span>;</span></span><br><span class="line">        color: $disabledColor;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这是comColorButton文件夹内的index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入组件，组件必须声明 name</span></span><br><span class="line"><span class="keyword">import</span> ComColorButton <span class="keyword">from</span> <span class="string">'./src/color-button.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 为组件提供 install 安装方法，供按需引入</span></span><br><span class="line">ComColorButton.install = <span class="function"><span class="keyword">function</span> (<span class="params">Vue</span>) </span>&#123;</span><br><span class="line">  Vue.component(ComColorButton.name, ComColorButton)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 默认导出组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ComColorButton</span><br></pre></td></tr></table></figure>

<p>这是 packages 文件夹内的index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ComColorButton <span class="keyword">from</span> <span class="string">'./comColorButton'</span></span><br><span class="line"><span class="comment">// 存储组件列表</span></span><br><span class="line"><span class="keyword">const</span> components = [</span><br><span class="line">  ComColorButton</span><br><span class="line">] </span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">  定义install 方法，接收Vue作为参数，如果使用use注册插件，则所有的组件都将被注册</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> install = <span class="function"><span class="keyword">function</span> (<span class="params">Vue</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 判断是否安装</span></span><br><span class="line">  <span class="keyword">if</span>(install.installed)&#123;<span class="keyword">return</span>&#125;</span><br><span class="line">  <span class="comment">// 遍历所有组件</span></span><br><span class="line">  components.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    Vue.component(item.name,item)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 判断是否引入文件</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span> &amp;&amp; <span class="built_in">window</span>.Vue)&#123;</span><br><span class="line">  install(<span class="built_in">window</span>.Vue)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">  install,</span><br><span class="line">  ComColorButton</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以上之后，组件就写完了，接下来就是引入组件了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* main.js */</span></span><br><span class="line"><span class="comment">// 导入组件库</span></span><br><span class="line"><span class="keyword">import</span> ComColorButton <span class="keyword">from</span> <span class="string">'./../packages/index'</span></span><br><span class="line"><span class="comment">// 注册组件库</span></span><br><span class="line">Vue.use(ComColorButton)</span><br></pre></td></tr></table></figure>

<p>使用组件库</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"hello"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com-color-button</span> <span class="attr">type</span>=<span class="string">"success"</span> <span class="attr">:disabled</span>=<span class="string">"false"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">com-color-button</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">com-color-button</span> <span class="attr">:disabled</span>=<span class="string">"true"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">com-color-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们可以看到效果：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/9/26/16d6b4b00ee600ff?w=818&h=632&f=png&s=22950" alt></p>
<h3 id="发布npm-方便直接在项目中引用"><a href="#发布npm-方便直接在项目中引用" class="headerlink" title="发布npm 方便直接在项目中引用"></a>发布npm 方便直接在项目中引用</h3><p>到此为止我们一个完整的组件库已经开发完成了，接下来就是发布到 npm 以供后期使用</p>
<h4 id="1、package-json-中新增一条编译为库的命令"><a href="#1、package-json-中新增一条编译为库的命令" class="headerlink" title="1、package.json 中新增一条编译为库的命令"></a>1、package.json 中新增一条编译为库的命令</h4><p>在库模式中，Vue是外置的，这意味着即使在代码中引入了 Vue，打包后的文件也是不包含Vue的。</p>
<p>以下我们在 scripts 中新增一条命令 npm run lib</p>
<ul>
<li>–target: 构建目标，默认为应用模式。这里修改为 lib 启用库模式。</li>
<li>–dest : 输出目录，默认 dist。这里我们改成 lib</li>
<li>[entry]: 最后一个参数为入口文件，默认为 src/App.vue。这里我们指定编译 packages/ 组件库目录。</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">"scripts": &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    "lib": "vue-cli-service build --target lib --name vcolorpicker --dest lib packages/index.js"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行编译库命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run lib</span><br></pre></td></tr></table></figure>

<p><img src="https://user-gold-cdn.xitu.io/2019/9/26/16d6b5af7920d49a?w=661&h=454&f=png&s=55267" alt><br>之后我们就可以看到会生成一个文件夹lib包含很多文件，长这样子的：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/9/26/16d6b4d68c9e8584?w=1080&h=953&f=png&s=179381" alt></p>
<h4 id="2、配置-package-json-文件中发布到-npm-的字段"><a href="#2、配置-package-json-文件中发布到-npm-的字段" class="headerlink" title="2、配置 package.json 文件中发布到 npm 的字段"></a>2、配置 package.json 文件中发布到 npm 的字段</h4><ul>
<li>name: 包名，该名字是唯一的。可在 npm 官网搜索名字，如果存在则需换个名字。</li>
<li>version: 版本号，每次发布至 npm 需要修改版本号，不能和历史版本号相同。</li>
<li>description: 描述。</li>
<li>main: 入口文件，该字段需指向我们最终编译后的包文件。</li>
<li>keyword：关键字，以空格分离希望用户最终搜索的词。</li>
<li>author：作者</li>
<li>private：是否私有，需要修改为 false 才能发布到 npm</li>
<li>license： 开源协议<br>以下为参考设置<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">"name": "com-color-button",</span><br><span class="line"> "version": "0.1.3",</span><br><span class="line"> "description": "基于 Vue 的按钮",</span><br><span class="line"> "main": "lib/comColorButton.umd.min.js",</span><br><span class="line"> "keyword": "colorButton button color",</span><br><span class="line"> "private": false,</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="3、添加-npmignore-文件，设置忽略发布文件"><a href="#3、添加-npmignore-文件，设置忽略发布文件" class="headerlink" title="3、添加 .npmignore 文件，设置忽略发布文件"></a>3、添加 .npmignore 文件，设置忽略发布文件</h4><p>我们发布到 npm 中，只有编译后的 lib 目录、package.json、README.md才是需要被发布的。所以我们需要设置忽略目录和文件。<br>和 .gitignore 的语法一样，具体需要提交什么文件，看各自的实际情况。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># 忽略目录</span><br><span class="line">examples&#x2F;</span><br><span class="line">packages&#x2F;</span><br><span class="line">public&#x2F;</span><br><span class="line"></span><br><span class="line"># 忽略指定文件</span><br><span class="line">vue.config.js</span><br><span class="line">babel.config.js</span><br><span class="line">*.map</span><br></pre></td></tr></table></figure>
<h4 id="4、登录到-npm"><a href="#4、登录到-npm" class="headerlink" title="4、登录到 npm"></a>4、登录到 npm</h4><p>首先需要到 npm 上注册一个账号,注意验证邮箱，不然之后会发布不了。<br>如果配置了淘宝镜像，先设置回npm镜像</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry http:&#x2F;&#x2F;registry.npmjs.org</span><br></pre></td></tr></table></figure>
<p>然后在终端执行登录命令，输入用户名、密码、邮箱即可登录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm login</span><br></pre></td></tr></table></figure>

<h4 id="5、发布到-npm"><a href="#5、发布到-npm" class="headerlink" title="5、发布到 npm"></a>5、发布到 npm</h4><p>执行发布命令，发布组件到 npm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish</span><br></pre></td></tr></table></figure>

<p><img src="https://user-gold-cdn.xitu.io/2019/9/26/16d6b5bc7ab28000?w=661&h=514&f=png&s=92420" alt><br>这里如果还没有验证邮箱的话话报个，需要验证邮箱的错误。去npm上验证邮箱即可，它会在页面顶部弹出个需要验证邮箱的提示。</p>
<h4 id="6、发布成功"><a href="#6、发布成功" class="headerlink" title="6、发布成功"></a>6、发布成功</h4><p>发布成功后稍等几分钟，可查看自己npm账号的packages，也可在 npm 官网搜索。 </p>
<p>去npm查看，我们可以packages下看到发布成功了，如下图：<br><img src="https://user-gold-cdn.xitu.io/2019/9/26/16d6b4f823ed90c6?w=1906&h=942&f=png&s=85791" alt></p>
<h4 id="7、使用新发布的组件库"><a href="#7、使用新发布的组件库" class="headerlink" title="7、使用新发布的组件库"></a>7、使用新发布的组件库</h4><p>安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install com-color-button -S</span><br></pre></td></tr></table></figure>

<p> 引入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--main.js--&gt;</span><br><span class="line"><span class="keyword">import</span> ComColorButton <span class="keyword">from</span> <span class="string">'com-color-button'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'com-color-button/lib/comColorButton.css'</span></span><br><span class="line">Vue.use(ComColorButton)</span><br></pre></td></tr></table></figure>

<p>组件中使用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">com-color-button</span> <span class="attr">type</span>=<span class="string">"success"</span>&gt;</span>按钮<span class="tag">&lt;/<span class="name">com-color-button</span>&gt;</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>到此就全部结束了，这都是亲自实践过的，可用。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://shetia.github.io/blog/2020/06/28/vue%E7%BB%84%E4%BB%B6%E5%8F%91%E5%B8%83npm/" data-id="ckcd5r5wt000pc0i2gbex6a7p" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/vue/" rel="tag">vue</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2020/07/08/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          快速排序
        
      </div>
    </a>
  
  
    <a href="/blog/2020/06/28/%E6%9F%AF%E9%87%8C%E5%8C%96/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">柯里化</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/css/" rel="tag">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/html/" rel="tag">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/blog/tags/vue/" rel="tag">vue</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/blog/tags/css/" style="font-size: 15px;">css</a> <a href="/blog/tags/html/" style="font-size: 20px;">html</a> <a href="/blog/tags/http/" style="font-size: 10px;">http</a> <a href="/blog/tags/js/" style="font-size: 15px;">js</a> <a href="/blog/tags/vue/" style="font-size: 20px;">vue</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2020/06/">六月 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2020/07/08/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F/">快速排序</a>
          </li>
        
          <li>
            <a href="/blog/2020/06/28/vue%E7%BB%84%E4%BB%B6%E5%8F%91%E5%B8%83npm/">vue组件发布npm</a>
          </li>
        
          <li>
            <a href="/blog/2020/06/28/%E6%9F%AF%E9%87%8C%E5%8C%96/">柯里化</a>
          </li>
        
          <li>
            <a href="/blog/2020/06/28/css%E6%8A%80%E5%B7%A7/">css技巧</a>
          </li>
        
          <li>
            <a href="/blog/2020/06/28/%E6%BB%9A%E5%8A%A8%E6%9D%A1%E6%A0%B7%E5%BC%8F/">滚动条样式</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 shetia<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">主页</a>
  
    <a href="/blog/archives" class="mobile-nav-link">档案</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">

  
<script src="/blog/fancybox/jquery.fancybox.pack.js"></script>




<script src="/blog/js/script.js"></script>




  </div>
</body>
</html>